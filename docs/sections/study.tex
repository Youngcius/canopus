\section{Case Studies}\label{sec:studies}


We validate the practical advantages of \canopus\ through two realistic case studies: the real-machine compilation and execution of Quantum Fourier Transform (QFT) circuits on IBM's QPU \code{ibm\_torino}, and the end-to-end simulation of compiled Quantum Low-Density Parity-Check (QLDPC) stabilizer circuits to assess its impact on the logical error rate.


\subsection{QFT kernel}\label{sec:qft_study}


\begin{figure}[tbp]
    \centering
    \subfigure[Mapping \code{qft\_6} by \toqm.]{
        \includegraphics[width=0.485\columnwidth]{figures/qft6_toqm.pdf}
    }\subfigure[Mapping \code{qft\_6} by \canopus.]{
        \includegraphics[width=0.485\columnwidth]{figures/qft6_canopus.pdf}
    }
    \caption{Mapping/routing comparison for the QFT kernel. For convenient visualization, only $ \CPhase $ and $ \SWAP $ gates are shown. (a) \toqm\ generates a sub-optimal mapping scheme, with 2Q depth of 10. (b) \canopus\ generates the optimal scheme in a perfect butterfly structure, with 2Q depth of 9.}
    \label{fig:qft_mapping}
\end{figure}



\begin{table}[tbp]
    \centering
    \caption{Qubit routing comparison for the QFT kernel.}
    \label{tab:qft_example}
    \begin{footnotesize}
        \input{tables/qft_example.tex}    
    \end{footnotesize}
\end{table}


QFT is a fundamental subroutine in many promising quantum algorithms, such as Shor's algorithm~\cite{shor1994algorithms}, quantum phase estimation~\cite{kitaev1995quantum}, etc. Given the extensive research on dedicated QFT compilers~\cite{zhang2021time,jin2024optimizing,maslov2007linear}, we select the state-of-the-art compiler \toqm, which specializes in QFT optimization, as our primary baseline.



A key finding is that \canopus\ can always achieves the optimal QFT routing scheme on 1D chain topology, while \toqm\ cannot not. Provably, the minimal number of $ \SWAP $ insertion to route an $ n $-qubit QFT is $ \frac{n(n-1)}{2} - 2 $, that is, 2 fewer than the original $ \CPhase $ count. This results in a perfect, symmetric butterfly circuit structure, as exemplified in \Cref{fig:qft_mapping} (b), with the minimal \#Can and 2Q circuit depth. Notably, this result is indeed optimal, surpassing the manually designed scheme previously reported as optimal by \citet{maslov2007linear} where 2 more $ \SWAP $ gates are required. This optimal scheme is irrespective of the target ISA. In contrast, our experiments show that \toqm\, despite claiming to realize the scheme from \cite{maslov2007linear}, fails to reproduce it and consistently yields inferior results to \canopus, as illustrated in \Cref{fig:qft_mapping}.

We compare compilation performance for both $ 6 $- and $ 12 $-qubit QFT kernels on both 1D chain and 2D square topologies, with results summarized in \Cref{tab:qft_example}. On the 1D chain, \canopus\ always produces the theoretically optimal routing result, while \toqm\ does not. For the small-scale \code{qft\_6} kernel on the 2D square, \canopus\ also achieves the optimal routing, superior to \toqm\ in both \#Can and 2Q depth. For the large-scale \code{qft\_12} kernel, \canopus\ consistently outperforms \toqm\ in both metrics.

\begin{figure}[tbp]
    \centering
    \includegraphics[width=\columnwidth]{figures/qft_cloud.pdf}
    \caption{QFT kernel fidelity comparison benchmarked on IBM\textsuperscript{Â®} Quantum Platform (\code{ibm\_torino}). \code{ibm\_torino} is the Heron-series QPU with native gate set $ \bigl\{\mathrm{CZ},\, \sqrt{\mathrm{X}},\, \mathrm{Z}(\theta)\bigr\} $.}
    \label{fig:qft_cloud}
\end{figure}

To further validate these results, we performed real-machine experiments on IBM's \code{ibm\_torino} QPU. We compiled QFT circuits of sizes $n \in \{6, 8, 10, 12\}$ for a 1D chain topology using both \canopus\ and the default \qiskit\ compiler. Although \code{ibm\_torino} has a heavy-hex topology, it contains linear chains of sufficient size for these benchmarks. Fidelity was measured using the Hellinger fidelity between the experimental and ideal output distributions, with the number of shots set to $\max\{4096, 2^n \times 10\}$. As shown in \Cref{fig:qft_cloud}, circuits compiled with \canopus\ achieve, on average, a \note{2x} reduction in $\CZ$ gate count, a \note{3x} reduction in 2Q-gate depth, and a \note{5x} improvement in program fidelity. These results unequivocally demonstrate the practical advantages of \canopus\ for QFT kernel compilation.



\subsection{QEC stabilizer circuit}


% \begin{figure}[tbp]
%     \centering
%     \includegraphics[width=\linewidth]{figures/better_check.pdf}
%     \caption{Stabilizer check circuit with less routing overhead. \ZY{delete this figure}}
%     \label{fig:stabilizer}
% \end{figure}


\begin{figure}[tbp]
    \centering
    \includegraphics[width=\linewidth]{figures/ler_topo_square.pdf}
    \includegraphics[width=\linewidth]{figures/ler_topo_hhex.pdf}
    \caption{Logical error rate of QLDPC stabilizer circuits compiled for square (top) and heavy-hex (bottom) topologies. The y-axis shows the relative logical error rate, which is normalized by the error rate of an ideal baseline circuit that assumes all-to-all connectivity.}
    \label{fig:stabilizer_result}
\end{figure}


QLDPC codes are rapidly moving from a topic of theoretical interest to a cornerstone of experimental fault-tolerant quantum computing (FTQC) research, mainly because this kind of codes has superior encoding efficiency than surface code \ZY{cite what?}. Implementing QLDPC codes on physical hardware is a formidable challenge due to their requirement for frequent long-range interactions~\cite{breuckmann2021quantum, panteleev2021degenerate}. While platforms like neutral-atom arrays~\cite{lin2025reuse, viszlai2023matching, pecorari2025high, xu2024constant} and trapped ions~\cite{bruzewicz2019trapped} can accommodate these interactions due to flexible connectivity, realizing QLDPC codes on superconducting processors with fixed, local connectivity is hampered by significant routing overheads~\cite{bravyi2024high,wang2025demonstration}. 

% We demonstrate that the ISA-aware optimization mechanism of \canopus\ is crucial to mitigating routing overhead across diverse QLDPC codes. Furthermore, we highlight that the $ \CX $-$ \iSWAP $ combinatorial native gate set particularly offers significant superiority than the only $ \CX $ basis gate for QEC. 

Stabilizer circuits are composed largely of $ \CX $ (or $ \CZ $) gates, while $ \CX $ $ \iSWAP $ is a well-known pair of mirror~\cite{cross2019validating} gates differing by a $ \SWAP $ gate. Consequently, an ISA incorporating both $ \iSWAP $ and $ \CX $ leads to significant opportunities to \dquote{pigyback} a $ \SWAP $ insertion on a $ \CX $ without incurring extra 2Q gate count. A similar observation was also employed in \citet{zhou2024halma} which uses to handle qubit defects in surface code, while it relied heavily on manual design and experience.


Therefore, we consider two kinds of ISAs---(1) \CXISA\ ISA with $ \CX $ as the 2Q basis gate; (2) \StabISA\ ISA with both $ \CX $ and $ \iSWAP $ as basis gates. $ \CX $ and $ \iSWAP $ are assumed to have an identical cost. Particularly, the \StabISA\ ISA corresponds to specific hardware realities, e.g., both $ \CZ $ and $ \iSWAP $ can be natively supported by the flux-tunable superconducting qubits~\cite{krantz2019quantum}. 


To validate how \canopus\ can actually enhance the QEC logical error suppression effect, we perform an end-to-end evaluation pipeline. We construct QLDPC code memory circuits from standard benchmarks~\cite{wang2025demonstration, panteleev2021degenerate} using the \code{qLDPC} package~\cite{perlin2023qldpc}. After the circuits are routed, we simulate them by \code{stim}\cite{Gidney2021StimAF} under a circuit-level noise model\cite{Dennis_2002, Acharya2022SuppressingQE}. Finally the error syndromes are decoded using the BPOSD decoder~\cite{panteleev2021degenerate, roffe2020decoding, hillmann2024localized} to determine the logical error rate.



As shown in \Cref{fig:stabilizer_result}, \canopus\ consistently achieves lower logical error rates than \sabre. Under the \CXISA, \canopus\ yields an average logical error suppression of \note{4x} on the square topology and \note{5x} on the heavy-hex topology compared to \sabre. The advantage becomes even more pronounced with the \StabISA, where \canopus\ achieves a \note{6x} (square) and \note{8x} (heavy-hex) error suppression. These results highlight two key findings: first, the ISA-aware mechanism in \canopus\ is highly effective for compiling QEC circuits, and second, the dedicated use of a hybrid $\CX$-$\iSWAP$ gate set offers a significant practical advantage for QLDPC code demonstrations on superconducting hardware.




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Hardware implementation of quantum LDPC (QLDPC) codes~\cite{breuckmann2021quantum, panteleev2021degenerate} remains highly challenging due to the frequent long-range interactions between qubits~\cite{bravyi2024high,wang2025demonstration}. Although emerging platforms such as neutral-atom~\cite{lin2025reuse, wang2024q, viszlai2023matching, pecorari2025high, xu2024constant} and ion-trap~\cite{wu2025boss, bruzewicz2019trapped} have shown greater potential for realizing QLDPC codes with less routing overhead, \canopus\ shows that the long-range interaction overhead can be suppressed significantly when combining the iSWAP and CX gates together --- our stabilizer ISA (\texttt{Stab-ISA}), marking an initial attempt at realizing QLDPC codes on superconducting platforms subject to topological constraints. A similar observation was also employed in~\cite{zhou2024halma} to handle defects, while it relied heavily on manual design and experience.

% Figure~\ref{fig:stabilizer} shows why the \texttt{Stab-ISA} can provide optimization space for FTQC circuit execution: One ancilla qubit (grey vertex) needs to interact with multiple data qubits (blue vertices) and be measured in the end to get the syndrome information. Performing an iSWAP gate makes it possible to conduct one CX and SWAP gate together, since the iSWAP gate can be decomposed into a CX, a SWAP, and some single-qubit rotations. This allows us to ``piggyback'' a SWAP on a CX without incurring an extra two-qubit gate, enabling ancilla movement across the lattice at no additional routing cost. Therefore, \emph{qubit 3} in Figure~\ref{fig:stabilizer} can be switched to \emph{position 2} "freely" without an additional SWAP gate, thus reducing the circuit depth from $3$ to $2$.

% We also build up a fully end-to-end evaluation pipeline using \code{stim}~\cite{Gidney2021StimAF} and \code{qLDPC}~\cite{perlin2023qldpc} to construct complete QLDPC code memory circuits under the circuit level noise model~\cite{Dennis_2002, Acharya2022SuppressingQE} and then decode the error syndrome using the BPOSD decoder~\cite{panteleev2021degenerate, roffe2020decoding, hillmann2024localized} to acquire the logical accuracy. We benchmark the logical error rate for these QLDPC code examples chosen from~\cite{wang2025demonstration, panteleev2021degenerate} in Figure~\ref{fig:duration_square} \ref{fig:duration_hhex} ~\ref{fig:ler_square} ~\ref{fig:ler_hhex}, with different kinds of ISAs including \texttt{CX}, \texttt{Stab} and hardware topologies including \texttt{Square}, \texttt{Hhex}. Note that \canopus\ with \texttt{Stab-ISA} achieves the lowest circuit duration and logical error rate, among all tested examples. The reductions of circuit duration and logical error further highlight the effectiveness of native compilation of iSWAP and CX gates in mitigating mapping and routing overhead for experimental QLDPC demonstrations.
